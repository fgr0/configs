#
# base settings
#

# allows for faster key repitition
set -s escape-time 0

# window index starts with 1
set -g base-index 1
set-window-option -g pane-base-index 1

# resize voodoo
setw -g aggressive-resize on

# activitiy monitoring
setw -g monitor-activity on

# auto window rename
set-window-option -g automatic-rename on

# terminal
set -g default-terminal "xterm-256color"
set-window-option -g xterm-keys on

# scrollback history to 10k lines
set -g history-limit 10000


#
# keybindings
#

# splits
bind-key 'S' split-window -h -c "#{pane_current_path}"
bind-key 's' split-window -v -c "#{pane_current_path}"

# pane resize
bind-key J resize-pane -D
bind-key K resize-pane -U
bind-key H resize-pane -L
bind-key L resize-pane -R

# vi pane movement
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# toggle sync
bind e setw synchronize-panes on
bind E setw synchronize-panes off

# use vi keybindings for tmux commandline input
set -g status-keys vi

# use vi keybindings in copy and choice modes
setw -g mode-keys vi

unbind [
bind v copy-mode
bind y copy-mode
bind Escape copy-mode

unbind p
bind p paste-buffer

bind -T copy-mode-vi 'v' send -X begin-selection
bind -T copy-mode-vi 'V' send -X rectangle-toggle
bind -T copy-mode-vi 'y' send -X copy-selection-and-cancel
bind -T copy-mode-vi Escape send -X cancel

# reload tmux config
unbind r
bind r \
    source-file ~/.tmux.conf \;\
    display 'Reloaded tmux config.'


#
# mouse
#

set -g mouse on

bind -n WheelUpPane if-shell -F -t = "#{mouse_any_flag}" "send-keys -M" "if -Ft= '#{pane_in_mode}' 'send-keys -M' 'copy-mode -e; send-keys -M'"


#
# ui
#

# status
set -g status-justify left # center window list
set -g status-left-length 30
set -g status-left "#[fg=colour244][ #[fg=colour254,bold]#S#[fg=colour244,nobold]:#[fg=colour33]#I.#[fg=colour33]#P#[fg=colour244,nobold] ] "
# set -g status-right "#[fg=colour244] %H:%M:%S #[fg=colour254,bold]#(whoami)#[fg=colour244,nobold]@#h #[fg=colour64]"
# set -g status-interval

# TODO: Disable Time/Refresh Rate. This apparently prevents the tmux crashing bug for now
set -g status-right "#[fg=colour254,bold]#(whoami)#[fg=colour244,nobold]@#h #[fg=colour64]"
set -g status-interval 0

# (solarized 256)
# default statusbar colors
set-option -g status-bg colour235 #base02
set-option -g status-fg colour136 #yellow
set-option -g status-attr default

# default window title colors
set-window-option -g window-status-fg colour244 #base0
set-window-option -g window-status-bg default
set-window-option -g window-status-attr dim

# active window title colors
set-window-option -g window-status-current-fg colour166 #orange
set-window-option -g window-status-current-bg default
# set-window-option -g window-status-current-attr dim

# activity and bell colors
set-window-option -g window-status-activity-attr bright,underscore
# set-window-option -g window-status-activity-fg colour64
set-window-option -g window-status-bell-attr none
set-window-option -g window-status-bell-bg default
set-window-option -g window-status-bell-fg default
set-window-option -g window-status-activity-attr none

# pane border
set-option -g pane-border-fg colour235 #base02
set-option -g pane-active-border-fg colour64 #base01

# message text
set-option -g message-bg colour235 #base02
set-option -g message-fg colour166 #orange

# pane number display
set-option -g display-panes-active-colour colour33 #blue
set-option -g display-panes-colour colour166 #orange

# clock
set-window-option -g clock-mode-colour colour64 #green


#
# source local config
#

if-shell "[ -f ~/.tmux.conf.local  ]" 'source ~/.tmux.conf.local'
